{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function () {\n        return m[k];\n      }\n    };\n  }\n\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.removeUnderscoresHex = exports.removeUnderscoresNoHex = exports.removeUnderscoresNumeric = exports.isValidUtf16 = exports.isBoxedPrimitive = exports.isBoxedBoolean = exports.isBoxedNumber = exports.isBoxedString = exports.isByteStringWithUnderscores = exports.isByteString = exports.isPrefixlessHexString = exports.isHexString = exports.base64Length = exports.isBase64 = exports.isPlainObject = exports.isUint8ArrayLike = exports.isWrappedResult = exports.isFunctionExternalInput = exports.isContractInput = exports.isEncodingTextInput = exports.isTypeValueInput = exports.isSafeNumber = exports.minValue = exports.maxValue = exports.places = void 0;\n\nconst big_js_1 = __importDefault(require(\"big.js\"));\n\nconst Conversion = __importStar(require(\"../conversion\"));\n\nconst isBoolean_1 = __importDefault(require(\"lodash/isBoolean\")); //recognizes boolean *or* Boolean\n\n\nconst isString_1 = __importDefault(require(\"lodash/isString\")); //recognizes string *or* String\n\n\nconst isNumber_1 = __importDefault(require(\"lodash/isNumber\")); //recognizes number *or* Number\n\n\nconst utf8_1 = __importDefault(require(\"utf8\"));\n\nfunction places(dataType) {\n  switch (dataType.typeClass) {\n    case \"int\":\n    case \"uint\":\n      return 0;\n\n    case \"fixed\":\n    case \"ufixed\":\n      return dataType.places;\n  }\n}\n\nexports.places = places;\n\nfunction maxValue(dataType) {\n  let bits = dataType.bits;\n\n  if (dataType.typeClass === \"int\" || dataType.typeClass === \"fixed\") {\n    bits -= 1; //subtract 1 for signed\n  }\n\n  const maxIntegerValue = new big_js_1.default(2).pow(bits).minus(1);\n  return Conversion.shiftBigDown(maxIntegerValue, places(dataType));\n}\n\nexports.maxValue = maxValue;\n\nfunction minValue(dataType) {\n  if (dataType.typeClass === \"uint\" || dataType.typeClass === \"ufixed\") {\n    return new big_js_1.default(0);\n  }\n\n  const minIntegerValue = new big_js_1.default(0).minus(new big_js_1.default(2).pow(dataType.bits));\n  return Conversion.shiftBigDown(minIntegerValue, places(dataType));\n}\n\nexports.minValue = minValue;\n\nfunction isSafeNumber(dataType, input) {\n  const scaledUp = input * 10 ** dataType.places;\n  return Number.MIN_SAFE_INTEGER <= scaledUp && scaledUp <= Number.MAX_SAFE_INTEGER;\n}\n\nexports.isSafeNumber = isSafeNumber;\n\nfunction isTypeValueInput(input) {\n  return typeof input === \"object\" && input !== null && typeof input.type === \"string\" && \"value\" in input && Object.keys(input).length === 2;\n}\n\nexports.isTypeValueInput = isTypeValueInput;\n\nfunction isEncodingTextInput(input) {\n  return typeof input === \"object\" && input !== null && typeof input.encoding === \"string\" && typeof input.text === \"string\" && Object.keys(input).length === 2;\n}\n\nexports.isEncodingTextInput = isEncodingTextInput;\n\nfunction isContractInput(input) {\n  return (typeof input === \"object\" || typeof input === \"function\") && input !== null && typeof input.address === \"string\" && //we *don't* check anything more for addresses, we'll let the\n  //address wrapper handle that\n  !(\"selector\" in input);\n}\n\nexports.isContractInput = isContractInput;\n\nfunction isFunctionExternalInput(input) {\n  return (typeof input === \"object\" || typeof input === \"function\") && input !== null && \"address\" in input && \"selector\" in input;\n}\n\nexports.isFunctionExternalInput = isFunctionExternalInput;\n\nfunction isWrappedResult(input) {\n  return typeof input === \"object\" && input !== null && typeof input.type === \"object\" && input.type !== null && typeof input.type.typeClass === \"string\" && (input.kind === \"value\" && typeof input.value === \"object\" || input.kind === \"error\" && typeof input.error === \"object\");\n}\n\nexports.isWrappedResult = isWrappedResult;\n\nfunction isUint8ArrayLike(input) {\n  return input instanceof Uint8Array || typeof input === \"object\" && input !== null && typeof input.length === \"number\";\n}\n\nexports.isUint8ArrayLike = isUint8ArrayLike; //hack?\n\nfunction isPlainObject(input) {\n  return typeof input === \"object\" && input !== null;\n}\n\nexports.isPlainObject = isPlainObject;\n\nfunction isBase64(input) {\n  const base64Pattern = /^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{2}([A-Za-z0-9+/]|=)=)?$/; //Vim's syntax highlighting is wrong here\n\n  return Boolean(input.match(base64Pattern));\n}\n\nexports.isBase64 = isBase64;\n\nfunction base64Length(base64) {\n  const [_, endingEquals] = base64.match(/(=*)$/); //note this match always succeeds\n\n  return base64.length * 3 / 4 - endingEquals.length;\n}\n\nexports.base64Length = base64Length;\n\nfunction isHexString(input) {\n  //(with prefix, to be clear)\n  const hexStringPattern = /^0[xX][0-9a-fA-F]*$/;\n  return Boolean(input.match(hexStringPattern));\n}\n\nexports.isHexString = isHexString;\n\nfunction isPrefixlessHexString(input) {\n  const shortHexStringPattern = /^[0-9a-fA-F]*$/;\n  return Boolean(input.match(shortHexStringPattern));\n}\n\nexports.isPrefixlessHexString = isPrefixlessHexString;\n\nfunction isByteString(input) {\n  const byteStringPattern = /^0[xX]([0-9a-fA-F]{2})*$/;\n  return Boolean(input.match(byteStringPattern));\n}\n\nexports.isByteString = isByteString;\n\nfunction isByteStringWithUnderscores(input) {\n  const byteStringWithUnderscoresPattern = /^0[xX](([0-9a-fA-F]{2}_?)*([0-9a-fA-F]{2}))?$/;\n  return Boolean(input.match(byteStringWithUnderscoresPattern));\n}\n\nexports.isByteStringWithUnderscores = isByteStringWithUnderscores;\n\nfunction isBoxedString(input) {\n  //unfortunately, isString has been typed incorrectly.\n  //it should return `input is string|String`, but instead it\n  //incorrectly returns `input is string`.  As such, we have\n  //to work around its incorrect typing here.\n  return (0, isString_1.default)(input) && typeof input !== \"string\";\n}\n\nexports.isBoxedString = isBoxedString;\n\nfunction isBoxedNumber(input) {\n  //see comment on isBoxedString\n  return (0, isNumber_1.default)(input) && typeof input !== \"number\";\n}\n\nexports.isBoxedNumber = isBoxedNumber;\n\nfunction isBoxedBoolean(input) {\n  //see comment on isBoxedString\n  return (0, isBoolean_1.default)(input) && typeof input !== \"boolean\";\n}\n\nexports.isBoxedBoolean = isBoxedBoolean;\n\nfunction isBoxedPrimitive(input) {\n  return isBoxedString(input) || isBoxedNumber(input) || isBoxedBoolean(input);\n}\n\nexports.isBoxedPrimitive = isBoxedPrimitive;\n\nfunction isValidUtf16(input) {\n  try {\n    utf8_1.default.encode(input); //encode but discard :P\n\n    return true;\n  } catch (_a) {\n    return false;\n  }\n}\n\nexports.isValidUtf16 = isValidUtf16;\n\nfunction removeUnderscoresNumeric(numeric) {\n  //if it contains 0x or 0X, treat as hex;\n  //otherwise, treat as non-hex (decimal/octal/binary)\n  return numeric.match(/0x/i) ? removeUnderscoresHex(numeric) : removeUnderscoresNoHex(numeric);\n}\n\nexports.removeUnderscoresNumeric = removeUnderscoresNumeric;\n\nfunction removeUnderscoresNoHex(numeric) {\n  //this would be easy with lookbehind assertions, but those aren't safe to use\n  //in all browsers, so, we're going to have to do things a bit more\n  //manually...\n  return removeUnderscoresWithRegex(numeric, /\\d_\\d/);\n}\n\nexports.removeUnderscoresNoHex = removeUnderscoresNoHex;\n\nfunction removeUnderscoresHex(hex) {\n  //same comment\n  return removeUnderscoresWithRegex(hex, /[\\da-f]_[\\da-f]/i);\n}\n\nexports.removeUnderscoresHex = removeUnderscoresHex; //note: regex should be of the form <A>_<A>, where <A> is a regex that matches\n//precisely one character!  this will not work otherwise!\n\nfunction removeUnderscoresWithRegex(input, regex) {\n  let match;\n\n  while (match = input.match(regex)) {\n    //replace input by the same thing but w/ the underscore removed,\n    //by taking the text before and after the underscore\n    input = input.slice(0, match.index + 1) + input.slice(match.index + 2);\n  }\n\n  return input;\n}","map":{"version":3,"mappings":"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","names":["places","dataType","typeClass","exports","maxValue","bits","maxIntegerValue","big_js_1","pow","minus","Conversion","shiftBigDown","minValue","minIntegerValue","isSafeNumber","input","scaledUp","Number","MIN_SAFE_INTEGER","MAX_SAFE_INTEGER","isTypeValueInput","type","Object","keys","length","isEncodingTextInput","encoding","text","isContractInput","address","isFunctionExternalInput","isWrappedResult","kind","value","error","isUint8ArrayLike","Uint8Array","isPlainObject","isBase64","base64Pattern","Boolean","match","base64Length","base64","_","endingEquals","isHexString","hexStringPattern","isPrefixlessHexString","shortHexStringPattern","isByteString","byteStringPattern","isByteStringWithUnderscores","byteStringWithUnderscoresPattern","isBoxedString","isBoxedNumber","isBoxedBoolean","isBoxedPrimitive","isValidUtf16","utf8_1","encode","removeUnderscoresNumeric","numeric","removeUnderscoresHex","removeUnderscoresNoHex","removeUnderscoresWithRegex","hex","regex","slice","index"],"sourceRoot":"","sources":["../../../lib/wrap/utils.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}