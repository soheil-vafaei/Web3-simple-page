{"ast":null,"code":"import getNCheck from \"nth-check\";\nimport boolbase from \"boolbase\";\n\nfunction getChildFunc(next, adapter) {\n  return elem => {\n    const parent = adapter.getParent(elem);\n    return parent != null && adapter.isTag(parent) && next(elem);\n  };\n}\n\nexport const filters = {\n  contains(next, text, _ref) {\n    let {\n      adapter\n    } = _ref;\n    return function contains(elem) {\n      return next(elem) && adapter.getText(elem).includes(text);\n    };\n  },\n\n  icontains(next, text, _ref2) {\n    let {\n      adapter\n    } = _ref2;\n    const itext = text.toLowerCase();\n    return function icontains(elem) {\n      return next(elem) && adapter.getText(elem).toLowerCase().includes(itext);\n    };\n  },\n\n  // Location specific methods\n  \"nth-child\"(next, rule, _ref3) {\n    let {\n      adapter,\n      equals\n    } = _ref3;\n    const func = getNCheck(rule);\n    if (func === boolbase.falseFunc) return boolbase.falseFunc;\n    if (func === boolbase.trueFunc) return getChildFunc(next, adapter);\n    return function nthChild(elem) {\n      const siblings = adapter.getSiblings(elem);\n      let pos = 0;\n\n      for (let i = 0; i < siblings.length; i++) {\n        if (equals(elem, siblings[i])) break;\n\n        if (adapter.isTag(siblings[i])) {\n          pos++;\n        }\n      }\n\n      return func(pos) && next(elem);\n    };\n  },\n\n  \"nth-last-child\"(next, rule, _ref4) {\n    let {\n      adapter,\n      equals\n    } = _ref4;\n    const func = getNCheck(rule);\n    if (func === boolbase.falseFunc) return boolbase.falseFunc;\n    if (func === boolbase.trueFunc) return getChildFunc(next, adapter);\n    return function nthLastChild(elem) {\n      const siblings = adapter.getSiblings(elem);\n      let pos = 0;\n\n      for (let i = siblings.length - 1; i >= 0; i--) {\n        if (equals(elem, siblings[i])) break;\n\n        if (adapter.isTag(siblings[i])) {\n          pos++;\n        }\n      }\n\n      return func(pos) && next(elem);\n    };\n  },\n\n  \"nth-of-type\"(next, rule, _ref5) {\n    let {\n      adapter,\n      equals\n    } = _ref5;\n    const func = getNCheck(rule);\n    if (func === boolbase.falseFunc) return boolbase.falseFunc;\n    if (func === boolbase.trueFunc) return getChildFunc(next, adapter);\n    return function nthOfType(elem) {\n      const siblings = adapter.getSiblings(elem);\n      let pos = 0;\n\n      for (let i = 0; i < siblings.length; i++) {\n        const currentSibling = siblings[i];\n        if (equals(elem, currentSibling)) break;\n\n        if (adapter.isTag(currentSibling) && adapter.getName(currentSibling) === adapter.getName(elem)) {\n          pos++;\n        }\n      }\n\n      return func(pos) && next(elem);\n    };\n  },\n\n  \"nth-last-of-type\"(next, rule, _ref6) {\n    let {\n      adapter,\n      equals\n    } = _ref6;\n    const func = getNCheck(rule);\n    if (func === boolbase.falseFunc) return boolbase.falseFunc;\n    if (func === boolbase.trueFunc) return getChildFunc(next, adapter);\n    return function nthLastOfType(elem) {\n      const siblings = adapter.getSiblings(elem);\n      let pos = 0;\n\n      for (let i = siblings.length - 1; i >= 0; i--) {\n        const currentSibling = siblings[i];\n        if (equals(elem, currentSibling)) break;\n\n        if (adapter.isTag(currentSibling) && adapter.getName(currentSibling) === adapter.getName(elem)) {\n          pos++;\n        }\n      }\n\n      return func(pos) && next(elem);\n    };\n  },\n\n  // TODO determine the actual root element\n  root(next, _rule, _ref7) {\n    let {\n      adapter\n    } = _ref7;\n    return elem => {\n      const parent = adapter.getParent(elem);\n      return (parent == null || !adapter.isTag(parent)) && next(elem);\n    };\n  },\n\n  scope(next, rule, options, context) {\n    const {\n      equals\n    } = options;\n\n    if (!context || context.length === 0) {\n      // Equivalent to :root\n      return filters[\"root\"](next, rule, options);\n    }\n\n    if (context.length === 1) {\n      // NOTE: can't be unpacked, as :has uses this for side-effects\n      return elem => equals(context[0], elem) && next(elem);\n    }\n\n    return elem => context.includes(elem) && next(elem);\n  },\n\n  hover: dynamicStatePseudo(\"isHovered\"),\n  visited: dynamicStatePseudo(\"isVisited\"),\n  active: dynamicStatePseudo(\"isActive\")\n};\n/**\n * Dynamic state pseudos. These depend on optional Adapter methods.\n *\n * @param name The name of the adapter method to call.\n * @returns Pseudo for the `filters` object.\n */\n\nfunction dynamicStatePseudo(name) {\n  return function dynamicPseudo(next, _rule, _ref8) {\n    let {\n      adapter\n    } = _ref8;\n    const func = adapter[name];\n\n    if (typeof func !== \"function\") {\n      return boolbase.falseFunc;\n    }\n\n    return function active(elem) {\n      return func(elem) && next(elem);\n    };\n  };\n}","map":{"version":3,"mappings":"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","names":["getNCheck","boolbase","getChildFunc","next","adapter","elem","parent","getParent","isTag","filters","contains","text","getText","includes","icontains","itext","toLowerCase","rule","equals","func","falseFunc","trueFunc","nthChild","siblings","getSiblings","pos","i","length","nthLastChild","nthOfType","currentSibling","getName","nthLastOfType","root","_rule","scope","options","context","hover","dynamicStatePseudo","visited","active","name","dynamicPseudo"],"sourceRoot":"https://raw.githubusercontent.com/fb55/css-select/0f0725a9dfeddd2fdb54eda9656cdbab5bbf6be6/src/","sources":["pseudo-selectors/filters.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}